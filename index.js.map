{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst PIXABAY_API_KEY = '49339894-31872ba4c3578b0a106bd0c96';\nconst PIXABAY_BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\n\nexport async function getImages(searchTerm, page = 1) {\n  try {\n    const response = await axios.get(PIXABAY_BASE_URL, {\n      params: {\n        key: PIXABAY_API_KEY,\n        q: searchTerm,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: PER_PAGE,\n        page,\n        lang: 'en',\n      },\n    });\n\n    if (response.data.hits.length === 0) {\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    }\n\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\n\nlet lightbox;\n\nexport const createGalleryMarkup = ({\n  webformatURL: smallIMG,\n  largeImageURL: largeIMG,\n  tags: alt,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  return `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeIMG}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${smallIMG}\"\n          alt=\"${alt}\"\n          loading=\"lazy\"\n        />\n      </a>\n      <ul class=\"description-list\">\n        <li class=\"description\"><span>Likes:</span> ${likes}</li>\n        <li class=\"description\"><span>Views:</span> ${views}</li>\n        <li class=\"description\"><span>Comments:</span> ${comments}</li>\n        <li class=\"description\"><span>Downloads:</span> ${downloads}</li>\n      </ul>\n    </li>`;\n};\n\nexport const createLightBox = () => {\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionDelay: 250,\n      captionsData: 'alt',\n    });\n  } else {\n    lightbox.refresh();\n  }\n};\n","import iziToast from 'izitoast';\nimport { getImages } from './js/pixabay-api';\nimport { createGalleryMarkup, createLightBox } from './js/render-functions';\n\nconst elements = {\n  searchForm: document.querySelector('.form'),\n  imageGallery: document.querySelector('.gallery'),\n  loaderBackdrop: document.querySelector('.backdrop'),\n  loadMoreBtn: document.querySelector('.load-more-btn'),\n};\n\nlet searchQuery = '';\nlet page = 1;\nconst PER_PAGE = 15;\nlet totalHits = 0;\n\nconst displayLoader = () =>\n  elements.loaderBackdrop.classList.remove('is-hidden');\nconst removeLoader = () => elements.loaderBackdrop.classList.add('is-hidden');\nconst showLoadMore = () => elements.loadMoreBtn.classList.remove('is-hidden');\nconst hideLoadMore = () => elements.loadMoreBtn.classList.add('is-hidden');\n\nconst showErrorToast = message => {\n  iziToast.error({\n    messageColor: '#fff',\n    backgroundColor: '#ef4040',\n    position: 'topRight',\n    message,\n    timeout: 5000,\n  });\n};\n\nconst handleSearchSubmit = async event => {\n  event.preventDefault();\n  searchQuery = event.currentTarget.elements['search-text'].value.trim();\n\n  if (searchQuery === '') {\n    showErrorToast('Please enter a search query!');\n    return;\n  }\n\n  page = 1;\n  elements.imageGallery.innerHTML = '';\n  hideLoadMore();\n  displayLoader();\n\n  try {\n    const { hits, totalHits: fetchedTotalHits } = await getImages(\n      searchQuery,\n      page\n    );\n    totalHits = fetchedTotalHits;\n\n    elements.imageGallery.innerHTML = hits.map(createGalleryMarkup).join('');\n    createLightBox();\n\n    if (totalHits > PER_PAGE) {\n      showLoadMore();\n      elements.loadMoreBtn.addEventListener('click', handleLoadMore);\n    }\n  } catch (error) {\n    showErrorToast(\n      error.message || 'Something went wrong. Please try again later.'\n    );\n  } finally {\n    removeLoader();\n    elements.searchForm.reset();\n  }\n};\n\nconst handleLoadMore = async () => {\n  hideLoadMore();\n  page += 1;\n  displayLoader();\n\n  try {\n    const { hits } = await getImages(searchQuery, page);\n    elements.imageGallery.insertAdjacentHTML(\n      'beforeend',\n      hits.map(createGalleryMarkup).join('')\n    );\n    createLightBox();\n\n    const cardHeight = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect().height;\n    window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n\n    if (page < Math.ceil(totalHits / PER_PAGE)) {\n      showLoadMore();\n    } else {\n      elements.loadMoreBtn.removeEventListener('click', handleLoadMore);\n      showErrorToast(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  } catch (error) {\n    showErrorToast(\n      error.message || 'Something went wrong. Please try again later.'\n    );\n  } finally {\n    removeLoader();\n  }\n};\n\nelements.searchForm.addEventListener('submit', handleSearchSubmit);\n"],"names":["PIXABAY_API_KEY","PIXABAY_BASE_URL","PER_PAGE","getImages","searchTerm","page","response","axios","error","lightbox","createGalleryMarkup","smallIMG","largeIMG","alt","likes","views","comments","downloads","createLightBox","SimpleLightbox","elements","searchQuery","totalHits","displayLoader","removeLoader","showLoadMore","hideLoadMore","showErrorToast","message","iziToast","handleSearchSubmit","event","hits","fetchedTotalHits","handleLoadMore","cardHeight"],"mappings":"owBAEA,MAAMA,EAAkB,qCAClBC,EAAmB,2BACnBC,EAAW,GAEV,eAAeC,EAAUC,EAAYC,EAAO,EAAG,CACpD,GAAI,CACF,MAAMC,EAAW,MAAMC,EAAM,IAAIN,EAAkB,CACjD,OAAQ,CACN,IAAKD,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAAG,EACA,KAAM,IACP,CACP,CAAK,EAED,GAAIC,EAAS,KAAK,KAAK,SAAW,EAChC,MAAM,IAAI,MACR,0EACR,EAGI,OAAOA,EAAS,IACjB,OAAQE,EAAO,CACd,cAAQ,MAAM,yBAA0BA,CAAK,EACvCA,CACP,CACH,CC9BA,IAAIC,EAEG,MAAMC,EAAsB,CAAC,CAClC,aAAcC,EACd,cAAeC,EACf,KAAMC,EACN,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACF,IACS;AAAA;AAAA,sCAE6BL,CAAQ;AAAA;AAAA;AAAA,iBAG7BD,CAAQ;AAAA,iBACRE,CAAG;AAAA;AAAA;AAAA;AAAA;AAAA,sDAKkCC,CAAK;AAAA,sDACLC,CAAK;AAAA,yDACFC,CAAQ;AAAA,0DACPC,CAAS;AAAA;AAAA,WAKtDC,EAAiB,IAAM,CAC7BT,EAOHA,EAAS,QAAO,EANhBA,EAAW,IAAIU,EAAe,aAAc,CAC1C,SAAU,GACV,aAAc,IACd,aAAc,KACpB,CAAK,CAIL,ECtCMC,EAAW,CACf,WAAY,SAAS,cAAc,OAAO,EAC1C,aAAc,SAAS,cAAc,UAAU,EAC/C,eAAgB,SAAS,cAAc,WAAW,EAClD,YAAa,SAAS,cAAc,gBAAgB,CACtD,EAEA,IAAIC,EAAc,GACdhB,EAAO,EACX,MAAMH,EAAW,GACjB,IAAIoB,EAAY,EAEhB,MAAMC,EAAgB,IACpBH,EAAS,eAAe,UAAU,OAAO,WAAW,EAChDI,EAAe,IAAMJ,EAAS,eAAe,UAAU,IAAI,WAAW,EACtEK,EAAe,IAAML,EAAS,YAAY,UAAU,OAAO,WAAW,EACtEM,EAAe,IAAMN,EAAS,YAAY,UAAU,IAAI,WAAW,EAEnEO,EAAiBC,GAAW,CAChCC,EAAS,MAAM,CACb,aAAc,OACd,gBAAiB,UACjB,SAAU,WACV,QAAAD,EACA,QAAS,GACb,CAAG,CACH,EAEME,EAAqB,MAAMC,GAAS,CAIxC,GAHAA,EAAM,eAAc,EACpBV,EAAcU,EAAM,cAAc,SAAS,aAAa,EAAE,MAAM,OAE5DV,IAAgB,GAAI,CACtBM,EAAe,8BAA8B,EAC7C,MACD,CAEDtB,EAAO,EACPe,EAAS,aAAa,UAAY,GAClCM,IACAH,IAEA,GAAI,CACF,KAAM,CAAE,KAAAS,EAAM,UAAWC,CAAgB,EAAK,MAAM9B,EAClDkB,EACAhB,CACN,EACIiB,EAAYW,EAEZb,EAAS,aAAa,UAAYY,EAAK,IAAItB,CAAmB,EAAE,KAAK,EAAE,EACvEQ,IAEII,EAAYpB,IACduB,IACAL,EAAS,YAAY,iBAAiB,QAASc,CAAc,EAEhE,OAAQ1B,EAAO,CACdmB,EACEnB,EAAM,SAAW,+CACvB,CACA,QAAY,CACRgB,IACAJ,EAAS,WAAW,OACrB,CACH,EAEMc,EAAiB,SAAY,CACjCR,IACArB,GAAQ,EACRkB,IAEA,GAAI,CACF,KAAM,CAAE,KAAAS,CAAI,EAAK,MAAM7B,EAAUkB,EAAahB,CAAI,EAClDe,EAAS,aAAa,mBACpB,YACAY,EAAK,IAAItB,CAAmB,EAAE,KAAK,EAAE,CAC3C,EACIQ,IAEA,MAAMiB,EAAa,SAChB,cAAc,eAAe,EAC7B,sBAAqB,EAAG,OAC3B,OAAO,SAAS,CAAE,IAAKA,EAAa,EAAG,SAAU,QAAQ,CAAE,EAEvD9B,EAAO,KAAK,KAAKiB,EAAYpB,CAAQ,EACvCuB,KAEAL,EAAS,YAAY,oBAAoB,QAASc,CAAc,EAChEP,EACE,4DACR,EAEG,OAAQnB,EAAO,CACdmB,EACEnB,EAAM,SAAW,+CACvB,CACA,QAAY,CACRgB,GACD,CACH,EAEAJ,EAAS,WAAW,iBAAiB,SAAUU,CAAkB"}