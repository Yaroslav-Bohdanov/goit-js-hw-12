{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst PIXABAY_API_KEY = '49339894-31872ba4c3578b0a106bd0c96';\nconst PIXABAY_BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\n\nexport async function getImages(searchTerm, page = 1) {\n  try {\n    const response = await axios.get(PIXABAY_BASE_URL, {\n      params: {\n        key: PIXABAY_API_KEY,\n        q: searchTerm,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: PER_PAGE,\n        page,\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw new Error('Failed to fetch images. Please try again.');\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\n\nlet lightbox;\n\nexport const createGalleryMarkup = ({\n  webformatURL: smallIMG,\n  largeImageURL: largeIMG,\n  tags: alt,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  return `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeIMG}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${smallIMG}\"\n          alt=\"${alt}\"\n          loading=\"lazy\"\n        />\n      </a>\n      <ul class=\"description-list\">\n        <li class=\"description\"><span>Likes:</span> ${likes}</li>\n        <li class=\"description\"><span>Views:</span> ${views}</li>\n        <li class=\"description\"><span>Comments:</span> ${comments}</li>\n        <li class=\"description\"><span>Downloads:</span> ${downloads}</li>\n      </ul>\n    </li>`;\n};\n\nexport const createLightBox = () => {\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionDelay: 250,\n      captionsData: 'alt',\n    });\n  } else {\n    lightbox.refresh();\n  }\n};\n","import iziToast from 'izitoast';\nimport { getImages } from './js/pixabay-api';\nimport { createGalleryMarkup, createLightBox } from './js/render-functions';\n\nconst elements = {\n  searchForm: document.querySelector('.form'),\n  imageGallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-more-btn'),\n};\n\nlet searchQuery = '';\nlet page = 1;\nconst PER_PAGE = 15;\nlet totalHits = 0;\n\nconst displayLoader = () => elements.loader.classList.remove('is-hidden');\nconst removeLoader = () => elements.loader.classList.add('is-hidden');\nconst showLoadMore = () => elements.loadMoreBtn.classList.remove('is-hidden');\nconst hideLoadMore = () => elements.loadMoreBtn.classList.add('is-hidden');\n\nconst showErrorToast = message => {\n  iziToast.error({\n    messageColor: '#fff',\n    backgroundColor: '#ef4040',\n    position: 'topRight',\n    message,\n    timeout: 5000,\n  });\n};\n\nconst updateGallery = hits => {\n  elements.imageGallery.insertAdjacentHTML(\n    'beforeend',\n    hits.map(createGalleryMarkup).join('')\n  );\n  createLightBox();\n};\n\nconst scrollToNewImages = () => {\n  const lastItem = elements.imageGallery.lastElementChild;\n  if (lastItem) {\n    lastItem.scrollIntoView({ behavior: 'smooth', block: 'end' });\n  }\n};\n\nconst handleSearchSubmit = async event => {\n  event.preventDefault();\n  searchQuery = event.currentTarget.elements['search-text'].value.trim();\n\n  if (searchQuery === '') {\n    showErrorToast('Please enter a search query!');\n    return;\n  }\n\n  page = 1;\n  elements.imageGallery.innerHTML = '';\n  hideLoadMore();\n  displayLoader();\n\n  try {\n    const { hits, totalHits: fetchedTotalHits } = await getImages(\n      searchQuery,\n      page\n    );\n    totalHits = fetchedTotalHits;\n\n    if (hits.length === 0) {\n      showErrorToast('No images found. Please try another search.');\n      return;\n    }\n\n    updateGallery(hits);\n\n    if (totalHits > PER_PAGE) {\n      showLoadMore();\n      elements.loadMoreBtn.addEventListener('click', handleLoadMore);\n    }\n  } catch (error) {\n    showErrorToast(\n      error.message || 'Something went wrong. Please try again later.'\n    );\n  } finally {\n    removeLoader();\n    elements.searchForm.reset();\n  }\n};\n\nconst handleLoadMore = async () => {\n  hideLoadMore();\n  page += 1;\n  displayLoader();\n\n  try {\n    const { hits } = await getImages(searchQuery, page);\n    updateGallery(hits);\n    scrollToNewImages();\n\n    if (page < Math.ceil(totalHits / PER_PAGE)) {\n      showLoadMore();\n    } else {\n      elements.loadMoreBtn.removeEventListener('click', handleLoadMore);\n      showErrorToast(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n  } catch (error) {\n    showErrorToast(\n      error.message || 'Something went wrong. Please try again later.'\n    );\n  } finally {\n    removeLoader();\n  }\n};\n\nelements.searchForm.addEventListener('submit', handleSearchSubmit);\n"],"names":["PIXABAY_API_KEY","PIXABAY_BASE_URL","PER_PAGE","getImages","searchTerm","page","axios","error","lightbox","createGalleryMarkup","smallIMG","largeIMG","alt","likes","views","comments","downloads","createLightBox","SimpleLightbox","elements","searchQuery","totalHits","displayLoader","removeLoader","showLoadMore","hideLoadMore","showErrorToast","message","iziToast","updateGallery","hits","scrollToNewImages","lastItem","handleSearchSubmit","event","fetchedTotalHits","handleLoadMore"],"mappings":"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"}